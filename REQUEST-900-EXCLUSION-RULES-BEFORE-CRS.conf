# https://github.com/coreruleset/coreruleset/blob/v4.0.0/rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example
#
# "...,ctl:ruleRemoveById=942100"
# "...,ctl:ruleRemoveByTag=attack-sqli"
# "...,ctl:ruleRemoveTargetById=942100;ARGS:password"
# "...,ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:password"

# Custom: reduce false positives on health checks
SecRule REQUEST_URI "@streq /healthz" \
    "id:1000001,phase:1,pass,nolog,ctl:ruleRemoveById=900100,ctl:ruleRemoveById=941110,ctl:ruleRemoveById=942100"

# Custom: exclude specific parameter from SQLi/XSS checks on /api/search
SecRule REQUEST_URI "@beginsWith /api/search" \
    "id:1000002,phase:1,pass,nolog,ctl:ruleRemoveTargetById=942100;ARGS:q,ctl:ruleRemoveTargetById=941110;ARGS:q"
